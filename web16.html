<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Clientes</title>
  </head>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6fb;
      margin: 0;
      padding: 0;
    }
    .flex {
      max-width: 400px;
      margin: 40px auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      padding: 32px 24px 24px 24px;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 18px;
    }
    h1 {
      font-size: 1.5rem;
      color: #2d3a4b;
      margin-bottom: 10px;
      text-align: center;
    }
    select {
      padding: 8px 12px;
      border-radius: 5px;
      border: 1px solid #bfc9d9;
      font-size: 1rem;
      margin-bottom: 10px;
      background: #f8fafc;
      transition: border 0.2s;
    }
    select:focus {
      border-color: #4f8cff;
      outline: none;
    }
    #details p {
      margin: 6px 0;
      color: #444;
      font-size: 1rem;
    }
    #details img {
      display: block;
      margin: 16px auto 0 auto;

      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
    }
  </style>
  <body>
    <div class="flex">
      <h1>Lista empleados</h1>
      <select name="" id="listEmp"></select>
      <div id="details"></div>
    </div>
  </body>
  <script src="js/jquery-3.7.1.js"></script>
  <script>
    let url = "https://apiclientesxml.azurewebsites.net";
    let request = "/api/Clientes/GetClientesXML";

    $(document).ready(function () {
      $.get(url + request, function (data) {
        $(data)
          .find("CLIENTE")
          .each(function () {
            let id = $(this).attr("IDCLIENTE");
            let nombre = $(this).find("NOMBRE").text();

            let $select = $("<option>");
            $select.text(nombre).attr("value", id);

            $("#listEmp").append($select);
          });
      });
    });

    // $(document).ready(function () {
    //   $("#listEmp").change(function () {
    //     let valorSeleccionado = $("#listEmp").val();
    //     let filter = "CLIENTE[IDCLIENTE=" + valorSeleccionado + "]";

    //     $.get(url + request, function (data) {
    //       $(data)
    //         .find(filter)
    //         .each(function () {
    //           let nombre = $(this).find("NOMBRE").first().text();
    //           let direccion = $(this).find("DIRECCION").first().text();
    //           let email = $(this).find("EMAIL").first().text();
    //           let codigopostal = $(this).find("CODIGOPOSTAL").first().text();
    //           let paginaweb = $(this).find("PAGINAWEB").first().text();
    //           let img = $(this).find("IMAGENCLIENTE").first().text();

    //           let $nombre = $("<p>");
    //           $nombre.text(nombre);

    //           let $direccion = $("<p>");
    //           $direccion.text(direccion);

    //           let $email = $("<p>");
    //           $email.text(email);

    //           let $codigopostal = $("<p>");
    //           $codigopostal.text(codigopostal);

    //           let $paginaweb = $("<p>");
    //           $paginaweb.text(paginaweb);

    //           let $img = $("<img>");
    //           $img.attr("src", img);

    //           $("#details").empty();
    //           $("#details").append(
    //             $nombre,
    //             $direccion,
    //             $email,
    //             $codigopostal,
    //             $paginaweb,
    //             $img
    //           );
    //         });
    //     });
    //   });
    // });

    $(document).ready(function () {
      $("#listEmp").change(function () {
        let valorSeleccionado = $("#listEmp").val();
        let requestClient = "/api/Clientes/" + valorSeleccionado;

        $.get(url + request, function (data) {
          $(data)
            .find("CLIENTE")
            .each(function () {
              let nombre = $(this).find("NOMBRE").first().text();
              let direccion = $(this).find("DIRECCION").first().text();
              let email = $(this).find("EMAIL").first().text();
              let codigopostal = $(this).find("CODIGOPOSTAL").first().text();
              let paginaweb = $(this).find("PAGINAWEB").first().text();
              let img = $(this).find("IMAGENCLIENTE").first().text();

              let $nombre = $("<p>", { text: nombre });

              let $direccion = $("<p>", { text: direccion });

              let $email = $("<p>", { text: email });

              let $codigopostal = $("<p>", { text: codigopostal });

              let $paginaweb = $("<p>", { text: paginaweb });

              let $img = $("<img>", { src: img });

              $("#details").empty();
              $("#details").append(
                $nombre,
                $direccion,
                $email,
                $codigopostal,
                $paginaweb,
                $img
              );
            });
        });
      });
    });
  </script>
</html>
